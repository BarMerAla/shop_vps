{%extends 'main/base.html'%}
{% load static %}

{% block title %}
        <title>–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–æ–≤–∞—Ä–∞</title>
{% endblock %}

{%block content%}

<main class="product-detail">
  <!-- –õ–µ–≤–∞—è —á–∞—Å—Ç—å -->
  <div style="width:60%;">
      <img src="{{item.photo.url}}" style="height:550px;">
  </div>
  <!-- –°—Ä–µ–¥–Ω—è—è —á–∞—Å—Ç—å -->
   <!-- üßæ –ë–ª–æ–∫ 1: –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
  <div class="product-detail-info" style="width:80%;">
      <h2 style="text-align:center;">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h2>
      <div class="spec-row">
        <span class="spec-name">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</span>
        <span class="spec-value">{{ item.category }}</span>
      </div>
      <div class="spec-row">
        <span class="spec-name">–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å</span>
        <span class="spec-value">{{ item.maker.name }} | {{ item.maker.country }}</span>
      </div>
      <div class="spec-row">
        <span class="spec-name">–¶–≤–µ—Ç</span>
        <span class="spec-value" style="margin-bottom: 30px;">{{ item.color }}</span>
      </div>
      <h2 style="text-align:center;">–û–ø–∏—Å–∞–Ω–∏–µ</h2>
      <div class="spec-row">
        <span class="full-description">{{ item.full_description|safe }}</span>
      </div>
  </div>
  <!-- –ü—Ä–∞–≤–∞—è —á–∞—Å—Ç—å -->
  <div class="product-buy" style="width:40%">
    <h2>{{ item.name }}</h2>
    <hr>
    <div class="product-price">
      {% load humanize %}
      {{ item.price|intcomma }} ‚Ç∏
    </div>
      <button id="checkout-button" class="buy-btn">–ö—É–ø–∏—Ç—å</button>
      <form action="{% url 'cart:cart_add' item.id %}" method="POST">
            {{ cart_one_form }}
            {% csrf_token %}
      <button type="submit" class="cart-btn">–í –∫–æ—Ä–∑–∏–Ω—É</button>
      </form>
  </div>
  <script>
    var stripe = Stripe('{{ stripe_public_key }}');
    document.getElementById("checkout-button").addEventListener('click', function () {
      fetch("{% url 'cart:create_checkout_session' item.id %}", {
          method: "POST",
          headers: {
              "X-CSRFToken": "{{ csrf_token }}",
              "Content-type": "application/json"
          },
      })
      .then(function (response) {
          return response.json();
      })
      .then(function (session) {
          return stripe.redirectToCheckout({sessionId: session.id});
      })
      .catch(function (error) {
          console.error("–û—à–∏–±–∫–∞: ", error);
      });
  });
  </script>
</main>

{%endblock%}